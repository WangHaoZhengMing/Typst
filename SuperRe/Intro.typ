#import "temple.typ": *
#set text(font: "PingFang SC")
#title_page(
  "结构相似性(SSIM)详解",
  "图像质量评估指标的理论基础",
  author: "作者：韩昊明"
)

= 引言

结构相似性(Structural Similarity, SSIM)是一种基于人类视觉感知系统设计的图像质量评估指标。与传统的均方误差(MSE)和峰值信噪比(PSNR)不同，SSIM不仅关注像素级别的差异，更注重图像的结构信息，从而能够更好地反映人眼对图像质量的主观感知。

= 理论基础

== 基本假设

SSIM的设计基于以下三个关键假设：
1. 人类视觉系统主要适用于提取图像的结构信息
2. 局部图像统计特性具有强烈的空间非平稳性
3. 局部亮度和对比度的差异会掩盖结构信息的感知

== 数学模型

SSIM通过比较两个图像窗口 $x$ 和 $y$ 之间的三个特征来评估图像质量：亮度（luminance）、对比度（contrast）和结构（structure）。

=== 统计量定义

对于图像窗口 $x$ 和 $y$，我们首先定义以下统计量：

- 平均值（亮度估计）：
$ μ_x = 1/N sum_(i=1)^N x_i $
$ μ_y = 1/N sum_(i=1)^N y_i $

- 标准差（对比度估计）：
$ σ_x = sqrt((1/(N-1)) sum_(i=1)^N (x_i - μ_x)^2) $
$ σ_y = sqrt((1/(N-1)) sum_(i=1)^N (y_i - μ_y)^2) $

- 协方差（结构相似性估计）：
$ σ_(x y) = 1/(N-1) sum_(i=1)^N (x_i - μ_x)(y_i - μ_y) $

=== SSIM指数计算

SSIM指数是通过三个比较函数的组合得到的：

1. 亮度比较函数：
$ l(x,y) = (2μ_x μ_y + C_1)/(μ_x^2 + μ_y^2 + C_1) $

2. 对比度比较函数：
$ c(x,y) = (2σ_x σ_y + C_2)/(σ_x^2 + σ_y^2 + C_2) $

3. 结构比较函数：
$ s(x,y) = (σ_(x y) + C_3)/(σ_x σ_y + C_3) $

其中 $C_1$、$C_2$ 和 $C_3$ 是小正常数，用于确保分母不为零，通常 $C_3 = C_2/2$。

最终的SSIM指数通过这三个比较函数的组合得到：

$ "SSIM"(x,y) = [l(x,y)]^α dot [c(x,y)]^β dot [s(x,y)]^γ $

其中 $α$、$β$ 和 $γ$ 是用于调整三个分量相对重要性的权重参数。在实践中，通常设置 $α = β = γ = 1$。

= 实际应用

== 均值SSIM（MSSIM）

对于整幅图像的质量评估，我们计算所有窗口的SSIM平均值：

$ "MSSIM"(X,Y) = 1/M sum_(j=1)^M "SSIM"(x_j,y_j) $

其中 $M$ 是图像中窗口的总数，$x_j$ 和 $y_j$ 是第 $j$ 个窗口的图像内容。

== 参数选择

在实际应用中，常用的参数设置为：
- 窗口大小：11×11
- $C_1 = (K_1 L)^2$，其中 $K_1 = 0.01$，$L$ 是像素值的动态范围
- $C_2 = (K_2 L)^2$，其中 $K_2 = 0.03$

#section_divider()
